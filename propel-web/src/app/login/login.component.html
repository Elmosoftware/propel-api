<!-- Based on the work of SamimOnline "My Awesome Login Page"
Bootstrap 4.1.1 Snippet https://bootsnipp.com/snippets/3522X -->
<div class="container h-100">
    <div class="d-flex justify-content-center h-100">
        <div class="user_card">
            <div class="d-flex justify-content-center">
                <div class="brand_logo_container">
                    <img src="../../assets/img/logo2-white.svg" class="brand_logo" alt="Logo">
                </div>
            </div>
            <div class="d-flex">
                <button class="btn btn-danger" type="button" (click)="goBack()" 
                matTooltip="Back" matTooltipClass="tooltipsWithBreakLines"
                matTooltipPosition="before">
                    <i class="fas fa-arrow-alt-circle-left fa-2x"></i></button>
            </div>
            <form [formGroup]="fg">
                <!-- PRELOAD FORM -->
                <!-- ================================================================= -->
                <div *ngIf="formFlow.activeFormSection == 'preload'"
                    class="d-flex flex-column justify-content-center form_container">
                    <div class="mt-4 mb-4 d-flex flex-row align-items-center justify-content-center">
                        <span class="subtitle white-text text-center">Starting ...</span>
                    </div>
                </div>

                <!-- USER FORM -->
                <!-- ================================================================= -->
                <div *ngIf="formFlow.activeFormSection == 'user'"
                    class="d-flex flex-column justify-content-center form_container">

                    <div class="mt-2 d-flex flex-row align-items-center justify-content-center">
                        <span class="title white-text text-center">Welcome to Propel!</span>
                    </div>

                    <div class="mt-3 text-mini text-center white-text message" [ngClass]="{
                         'error-message': formFlow.messageIsError
                        }">{{formFlow.message}}</div>

                    <div class="mt-3 form-group">
                        <input type="text" class="form-control" id="name" aria-describedby="name"
                            placeholder="Your account name here" formControlName="name" required
                            (keydown.enter)="continue()">
                        <app-validation-message [control]="fg.controls.name"></app-validation-message>
                    </div>

                    <div class="mt-3 form-group">
                        <div class="d-flex justify-content-center align-items-end">
                            <button class="btn btn-danger w-75" type="button" [disabled]="!fg.controls.name.valid"
                                (click)="continue()">Continue</button>
                        </div>
                    </div>
                </div>

                <!-- PASSWORD FORM -->
                <!-- ================================================================= -->
                <div *ngIf="formFlow.activeFormSection == 'password'"
                    class="d-flex flex-column justify-content-center form_container">

                    <!-- User name and initials -->
                    <div class="mt-2 d-flex flex-row align-items-center justify-content-center">
                        <div class="text-circle">
                            {{formFlow.user.initials}}
                        </div>
                        <span class="title white-text text-center ml-2">{{formFlow.user.fullName}}</span>
                    </div>

                    <!-- Form message -->
                    <div class="mt-3 text-mini text-center white-text message" [ngClass]="{
                         'error-message': formFlow.messageIsError
                        }">{{formFlow.message}}</div>

                    <!-- Authentication code or Password-->
                    <div class="mt-3 d-flex justify-content-center">
                        <div class="input-group">
                            <input [type]="viewAuthCodeOrPassword ? 'text' : 'password'"
                                class="form-control remove-border-right" id="authCodeOrPassword"
                                aria-describedby="authCodeOrPassword"
                                [placeholder]="formFlow.authCodeOrPasswordPlaceholder"
                                formControlName="authCodeOrPassword" 
                                (keydown.enter)="login()" required>
                            <div class="input-group-append">
                                <span class="input-group-text">
                                    <i class="fas" (click)="toggleViewAuthCodeOrPassword()" [ngClass]="{
                                        'fa-eye-slash': !viewAuthCodeOrPassword,
                                        'fa-eye': viewAuthCodeOrPassword
                                      }"></i></span>
                            </div>
                        </div>
                    </div>
                    <app-validation-message [control]="fg.controls.authCodeOrPassword"></app-validation-message>

                    <!-- Password for regular login or a new password for a first login or password reset operations: -->
                    <div *ngIf="formFlow.loginType != 0" class="mt-3 d-flex justify-content-center">
                        <div class="input-group">
                            <input [type]="viewNewPassword ? 'text' : 'password'"
                                class="form-control remove-border-right" id="newPassword" 
                                aria-describedby="newPassword"
                                placeholder="Enter here your new password" formControlName="newPassword" 
                                required>
                            <div class="input-group-append">
                                <span class="input-group-text">
                                    <i class="fas" (click)="toggleViewNewPassword()" [ngClass]="{
                                        'fa-eye-slash': !viewNewPassword,
                                        'fa-eye': viewNewPassword
                                      }"></i></span>
                            </div>
                        </div>
                    </div>
                    <app-validation-message [control]="fg.controls.newPassword"></app-validation-message>

                    <!-- Password confirmation when a new password is set: -->
                    <div *ngIf="formFlow.loginType != 0" class="mt-3 d-flex justify-content-center">
                        <div class="input-group">
                            <input [type]="viewPasswordConfirmation ? 'text' : 'password'"
                                class="form-control remove-border-right" id="passwordConfirmation"
                                aria-describedby="passwordConfirmation" 
                                placeholder="Confirm your new password here"
                                formControlName="passwordConfirmation" 
                                (keydown.enter)="login()"
                                required>
                            <div class="input-group-append">
                                <span class="input-group-text">
                                    <i class="fas" (click)="toggleViewPasswordConfirmation()" [ngClass]="{
                                        'fa-eye-slash': !viewPasswordConfirmation,
                                        'fa-eye': viewPasswordConfirmation
                                      }"></i></span>
                            </div>
                        </div>
                    </div>
                    <app-validation-message [control]="fg.controls.passwordConfirmation"></app-validation-message>

                    <div class="mt-3 form-group">
                        <div class="d-flex justify-content-center align-items-end">
                            <button class="btn btn-danger w-75" type="button" [disabled]="!fg.valid"
                                (click)="login()">Login</button>
                        </div>
                    </div>
                </div>
            </form>
            <!-- <div class="mt-4">
                <div class="d-flex justify-content-center links">
                    Don't have an account? <a href="#" class="ml-2">Sign Up</a>
                </div>
                <div class="d-flex justify-content-center links">
                    <a href="#">Forgot your password?</a>
                </div>
            </div> -->
        </div>
    </div>
</div>